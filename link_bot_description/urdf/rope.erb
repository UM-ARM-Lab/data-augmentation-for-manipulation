<%num_links = 20%>
<%mass = 2.0%>
<%length = 4.0%>
<%radius = 0.05%>
<%link_length = length/num_links%>
<%link_mass = 10.0/num_links%>
<?xml version="1.0" ?>
<robot name="rope">
    <% for i in 0..num_links %>
    <link name="link_<%=i%>">
        <visual>
            <origin rpy="0 -1.5707 0" xyz="<%=link_length / 2.0 - radius / 2.0%> 0 0"/>
            <geometry>
                <cylinder length="<%=link_length%>" radius="<%=radius%>"/>
            </geometry>
        </visual>
        <collision>
            <origin rpy="0 -1.5707 0" xyz="<%=link_length / 2.0 - radius / 2.0%> 0 0"/>
            <geometry>
                <box size="<%=radius*2%> <%=radius*2%> <%=link_length%>"/>
            </geometry>
            <surface>
                <friction>
                    <ode>
                        <mu>0.1</mu>
                        <mu2>0.1</mu2>
                    </ode>
                </friction>
            </surface>
        </collision>
        <inertial>
            <mass value="<%=link_mass%>"/>
            <inertia ixx="3.333" ixy="0" ixz="0" iyy="0" iyz="0" izz="3.333"/>
            <origin rpy="0 0 0" xyz="<%=link_length - radius / 2.0%> 0 0"/>
        </inertial>
    </link>
    <% end %>

    <% for i in 0..num_links-1 %>
    <joint name="joint_<%=i%>" type="revolute">
        <parent link="link_<%=i%>"/>
        <child link="link_<%=i+1%>"/>
        <origin xyz="<%=link_length - radius/2.0%> 0 0"/>
        <axis xyz="0 0 1"/>
        <limit lower="-2" upper="2" effort="10" velocity="2"/>
        <dynamics damping="1" friction="0.0"/>
    </joint>
    <% end %>
    <gazebo>
        <plugin name="linkbot_model_plugin" filename="liblinkbot_model_plugin.so">
            <kP>600.0</kP>
            <kI>10.0</kI>
            <kD>1.0</kD>
            <action_scale>1</action_scale>
        </plugin>
    </gazebo>
</robot>
